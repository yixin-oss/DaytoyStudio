---
title: 余切拉普拉斯算子与矢量场离散散度定理推导
---

离散余切拉普拉斯算子 (Cotangent Laplace-Beltrami Operator) 与矢量场的离散散度公式是计算几何 / 计算机图形学中诸多算法的理论基础, 它们本质上都源于**散度定理**, 即"将对区域的积分与对边界的积分建立联系". 下面将对这两个离散公式的推导进行介绍.

## 余切拉普拉斯算子

**散度定理**: "对散度的面积分=梯度对边界的线积分", i.e., 
$$
\begin{equation}
\int_{A_i} {\rm div} ~F(u)~{\rm dA}=\int_{\partial A_i}F(u)\cdot n(u) {\rm ds},
\end{equation}
$$
其中$\partial A_i$ 表示点$x_i$的Vonoroi区域$A_i$的边界, $F$表示定义在区域上的函数, $n$ 表示区域边界的外法向量.

将散度定理应用于拉普拉斯算子$(\Delta)$, 将对三角面片上定义的线性函数$f$的梯度$\nabla f$的散度${\rm div}~\nabla f$的面积分转化成对边界的积分, i.e.,
$$
\begin{equation}
\int_{A_i}\Delta f(u) ~{\rm dA}=\int_{A_i}{\rm div} ~\nabla f(u) ~{\rm dA} =\int_{\partial A_i} \nabla f(u)\cdot n ~{\rm ds}. 
\end{equation}
$$
对每个三角形$T$内的区域计算其相应积分, 梯度可视为不参与积分的常量, i,e., 
$$
\begin{equation}
\int_{\partial A_i\cap T} \nabla f(u)\cdot n(u) {\rm ds}=\nabla f(u) \cdot \int_{\partial A_i\cap T}n(u){\rm ds}=\nabla f(u) \cdot (a-b)^{\perp}=\frac{1}{2}\nabla f(u)\cdot(x_j-x_k)^{\perp},
\end{equation}
$$
其中$x_j,~x_k$是三角形$T$的两个顶点, $a, ~b$是对应边中点, 如图所示.

<img src="https://gitee.com/yixin-oss/blogImage/raw/master/Img/image-20250729192704057.png" alt="image-20250729192704057" style="zoom: 50%;" />

下面将给出梯度的离散形式.

### 梯度离散化

① 重心坐标定理: 已知三角形三个顶点处的值$g_i,~g_j,~g_k$, 则利用插值可以得到三角形内部任一点处的值$g$, i.e., 
$$
\begin{equation}
\begin{aligned}
& g=\alpha g_i+\beta g_j+\gamma g_k,\\
& \alpha+\beta+\gamma=1,\\
& \alpha,~ \beta,~ \gamma~>0,\\
& \alpha=\frac{S_i}{S_i+S_j+S_k},~ \beta=\frac{S_j}{S_i+S_j+S_k},~\gamma=\frac{S_k}{S_i+S_j+S_k},
\end{aligned}
\end{equation}
$$
这里$S_i$是$g_i$对面与$g$组成的小三角形的面积, $S_j,~ S_k$同理.

② 函数定义: 由上述重心坐标定理, 定义在三角形上的线性函数$f$可表示为$f(x)=\alpha f_i+\beta f_j+\gamma f_k$.

③ 梯度定义: $\nabla_x f(x)=\nabla_x \alpha f_i+ \nabla_x \beta f_j+\nabla_x f_k$.

④ 梯度求解: 利用三角形面积公式对梯度进行求解.

<img src="https://gitee.com/yixin-oss/blogImage/raw/master/Img/%E4%B8%89%E8%A7%92%E5%BD%A2.png" alt="三角形" style="zoom: 67%;" />

记三角形面积为$A_T$, 以$\alpha$为例, 对于$x_i$对应小三角形的面积$S_i$, 底是$\|x_k-x_j\|_2$, 高是$(x-x_j)$在$(x_k-x_j)$垂直方向上的投影, i.e.,  
$$
\begin{equation}
\alpha=\frac{S_i}{A_T}=\frac{\frac{1}{2}\|x_k-x_j\|_2(x-x_j)\cdot\frac{(x_k-x_j)^{\perp}}{\|x_k-x_j\|_2}}{A_T}=\frac{(x-x_j)(x_k-x_j)^{\perp}}{2A_T}.
\end{equation}
$$
对$x$求导可得
$$
\begin{equation}
\nabla_x \alpha=\frac{(x_k-x_j)^{\perp}}{2A_T},
\end{equation}
$$
同理有
$$
\begin{equation}
\nabla_x \beta=\frac{(x_i-x_k)^{\perp}}{2A_T}, \nabla_x \gamma=\frac{(x_j-x_i)^{\perp}}{2A_T},
\end{equation}
$$
则有梯度
$$
\begin{equation}
\nabla_x f=f_i\frac{(x_k-x_j)^{\perp}}{2A_T}+f_j\frac{(x_i-x_k)^{\perp}}{2A_T}+f_k\frac{(x_j-x_i)^{\perp}}{2A_T}.
\end{equation}
$$
由$(x_k-x_j)+(x_i-x_k)+(x_j-x_i)=0$, 所有向量旋转$90^{\circ}$再相加结果不变, i.e.,
$$
(x_k-x_j)^{\perp}+(x_i-x_k)^{\perp}+(x_j-x_i)^{\perp}=0.
$$
将$x_k-x_j$替换, 可将离散梯度公式进一步化简为
$$
\begin{equation}
\nabla_xf=(f_j-f_i)\frac{(x_i-x_k)^{\perp}}{2A_T}+(f_k-f_i)\frac{(x_j-x_i)^{\perp}}{2A_T},
\end{equation}
$$
则有
$$
\begin{equation}
\int_{\partial A_i\cap T}\nabla f(u)\cdot n(u)~ {\rm ds}=(f_j-f_i)\frac{(x_i-x_k)^{\perp}(x_j-x_k)^{\perp}}{4A_T}+(f_k-f_i)\frac{(x_j-x_i)^{\perp}(x_j-x_k)^{\perp}}{4A_T}.
\end{equation}
$$
记$\gamma_j,~\gamma_k$表示以$x_j,~ x_k$为顶点的角, 由三角形面积公式
$$
\begin{equation}
A_T=\frac{1}{2}\sin{\gamma_j}\|x_j-x_i\|\|x_j-x_k\|=\frac{1}{2}\sin{\gamma_k}\|x_i-x_k\|\|x_j-x_k\|,
\end{equation}
$$
及向量点乘
$$
\begin{equation}
\cos \gamma_j=\frac{(x_j-x_i)(x_j-x_k)}{\|x_j-x_i\|\|x_j-x_k\|}, \cos \gamma_k=\frac{(x_i-x_k)(x_j-x_k)}{\|x_j-x_k\|\|x_i-x_k\|},
\end{equation}
$$
可得
$$
\begin{equation}
\int_{\partial A_i\cap T} \nabla f(u)\cdot n(u) {\rm ds}=\frac{1}{2}\big(\cot\gamma_k(f_j-f_i)+\cot\gamma_j(f_k-f_i)\big).
\end{equation}
$$
将所有三角形对应部分相加, 易知每条边对应两个角, i.e.,
$$
\begin{equation}
\begin{aligned}
&\int_{A_i}\Delta f(u) {\rm dA}=\frac{1}{2}[\sum_{v_j\in\mathcal{N}(v_i)}(\cot\alpha_{ij}+\cot\beta_{ij})(f_j-f_i)]\\
& \Rightarrow\\
& \Delta f(u_i)=\frac{1}{2A_i}[\sum_{v_j\in\mathcal{N}(v_i)}(\cot\alpha_{ij}+\cot\beta_{ij})(f_j-f_i)],
\end{aligned}
\end{equation}
$$
为了便于理解, 上述推导过程中$A_i$既表示了点$x_i$的Vonoroi区域也表示Vonoroi面积.

------

下面继续介绍矢量场的散度公式

## 矢量场散度公式

1. 连续散度

散度表示**单位区域内矢量场的净通量**, i.e.,
$$
\begin{equation}
\nabla\cdot X|_i=\lim_{\Omega_i\rightarrow0}\frac{1}{|\Omega_i|}\int_{\partial\Omega_i}X\cdot n~ {\rm ds},
\end{equation}
$$
其中$|\Omega_i|$是顶点$i$的邻域面积.

2. 离散化推导

① 对顶点$i$的邻域$\Omega_i$应用散度定理, i.e., 
$$
\begin{equation}
\int_{\Omega_i}\nabla\cdot X {\rm dA}=\int_{\partial \Omega_i}X\cdot n~ {\rm ds},
\end{equation}
$$
左侧近似点态散度乘以面积, 可得
$$
\begin{equation}
(\nabla\cdot X)_i \cdot A_i\approx \int_{\partial \Omega_i}X\cdot n~ {\rm ds}.
\end{equation}
$$
② 边界积分离散化

将边界$\partial \Omega_i$分解为各邻接三角片$T$的贡献, i,e.,
$$
\begin{equation}
\int_{\partial \Omega_i}X\cdot n~ {\rm ds}=\sum_{T\in\mathcal{N}(v_i)}\int_{\partial\Omega_i\cap T}X\cdot n~ {\rm ds}.
\end{equation}
$$
在每个三角片$T$上, 边界积分可近似为

[^]: 可利用坐标法证明.


$$
\begin{equation}
\int_{\partial\Omega_i\cap T}X\cdot n~ {\rm ds}\approx \frac{1}{2}[\cot \theta_1 (e_1\cdot X_T)+\cot \theta_2(e_2\cdot X_T)],
\end{equation}
$$
其中$e_1,~e_2$是三角片$T$中与顶点$v_i$相连的两条边向量, $\alpha,~\beta$分别是两个边向量所对的角, $X_T$是矢量场$X$在三角片$T$上对应的值, 如图所示.

<img src="https://gitee.com/yixin-oss/blogImage/raw/master/Img/image-20250730173807259.png" alt="Div" style="zoom:150%;" />

③ 合并顶点总积分散度
$$
\begin{equation}
\int_{\partial\Omega}X\cdot n~ {\rm ds}=\frac{1}{2}\sum_{T\in \mathcal{N}(v_i)}[\cot \theta_1 (e_1\cdot X_T)+\cot \theta_2(e_2\cdot X_T)].
\end{equation}
$$
④ 点态散度公式
$$
\begin{equation}
(\nabla \cdot X)_i\approx\frac{1}{2A_i}\sum_{T\in \mathcal{N}(v_i)}[\cot \theta_1 (e_1\cdot X_T)+\cot \theta_2(e_2\cdot X_T)],
\end{equation}
$$
其中$A_i$是顶点$v_i$的Vonoroi邻域$\Omega_i$的面积.

## 参考资料

[1] BOTSCH M, KOBBELT L, PAULY M, et al. Polygon Mesh Processing[M]. Natick, Mass: A K Peters/CRC Press. 2010. DOI:10.1201/b10688.
[2] [闪电彬彬CSDN](https://blog.csdn.net/chenbb1989/article/details/131884364)
[3] [闪电彬彬微信公众号](https://mp.weixin.qq.com/s/omAm0IwWXKoJwLMiJELcCg)