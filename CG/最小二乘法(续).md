---
title: Least Square Method (Continued)
---

## Classic matrix differentiation

For a given matrix $A$ and its corresponding function $f(x)=x^TAx$, we have 
$$
\begin{equation}
\nabla_x f(x)=(A+A^T)x.
\end{equation}
$$
Specifically, if $A$ is a symmetry matrix, i.e., $A^T=A$, then
$$
\begin{equation}
\nabla_x f(x)=2Ax.
\end{equation}
$$

- For clarity, we take a two-dimensional matrix as an example. Denote $x, A$ as

$$
x=
\begin{bmatrix}
x1\\
x2
\end{bmatrix},
A=
\begin{bmatrix}
a & b\\
c & d
\end{bmatrix},
$$

then
$$
f(x)=x^TAx=ax_1^2+(b+c)x_1x_2+dx_2^2.
$$

- Taking the derivative of $f(x)$ with respect to $x_1$ and $x_2$ yields

$$
\begin{equation}
\nabla_xf(x)=
\begin{bmatrix}
2x_1+(b+c)x_2\\
(b+c)x_1+2dx_2
\end{bmatrix}
=
\Bigg(
\begin{bmatrix}
a & b\\
c & d
\end{bmatrix}
+
\begin{bmatrix}
a & c\\
b & d
\end{bmatrix}
\Bigg)
\begin{bmatrix}
x_1\\
x_2
\end{bmatrix}
=(A+A^T)x.
\end{equation}
$$

- For the least square problem, 

$$
\begin{equation}
J(x)=\|Ax-b\|^2=(Ax-b)^T(Ax-b)=x^TA^TAx-2b^TAx+b^Tb,
\end{equation}
$$

then $\nabla_x f(x)=2A^TAx$ since $A^TA$ is a symmetry matrix.

## Sum of Least Squares problems

$\bullet$ **The minimization problem of the sum of the objective functions in least squares problems is equivalent to solving the sum of the corresponding normal equations.**

For the sum of two objective functions in least square problems, i.e., 
$$
\begin{equation}
\begin{aligned}
J(x) & = \|A_1x-b_1\|^2+\|A_2x-b_2\|^2\\
& =(A_1x-b_1)^T(A_1x-b_1)+(A_2x-b_2)^T(A_2x-b_2),
\end{aligned}
\end{equation}
$$
taking its derivative and setting it to zero yields the globally optimal conditions (also referred to as the system of normal equations):
$$
\begin{equation}
(A_1^TA_1+A_2^TA_2)x=A_1^Tb_1+A_2^Tb_2.
\end{equation}
$$
Additionally, by combing them into a new least square problem, i.e.,
$$
\min_x \bigg|
\begin{bmatrix}
A_1\\
A_2
\end{bmatrix}
x-
\begin{bmatrix}
b_1\\
b_2
\end{bmatrix}
\bigg|^2,
$$
we can obtain the same normal equation as above.



